{"ast":null,"code":"import _regeneratorRuntime from\"/Users/manmanbbg/Desktop/degree/FYP/project/FYP_UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/manmanbbg/Desktop/degree/FYP/project/FYP_UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/manmanbbg/Desktop/degree/FYP/project/FYP_UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import{useSnackbar}from\"notistack\";import axios from\"axios\";var useFetch=function useFetch(initialUrl){var skip=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var apiUrl=window.siteSetting.dev?window.siteSetting.testApiUrl:window.siteSetting.apiUrl;var _useState=useState(apiUrl+initialUrl),_useState2=_slicedToArray(_useState,1),url=_useState2[0];// const [params] = useState(initialParams);\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),hasError=_useState8[0],setHasError=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),errorMessage=_useState10[0],setErrorMessage=_useState10[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,response,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!skip){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setIsLoading(true);_context.prev=3;token=localStorage.getItem(\"Token\");_context.next=7;return axios.get(url,{headers:{Authorization:\"Bearer \".concat(token)}});case 7:response=_context.sent;_context.next=10;return response.data;case 10:result=_context.sent;if(result){setData(result);}else{setHasError(true);setErrorMessage(result);}_context.next=19;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](3);setHasError(true);setErrorMessage(_context.t0.message);enqueueSnackbar(\"Get Data Error\",{variant:\"error\"});case 19:_context.prev=19;setIsLoading(false);return _context.finish(19);case 22:case\"end\":return _context.stop();}}},_callee,null,[[3,14,19,22]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[url]);return{data:data,isLoading:isLoading,hasError:hasError,errorMessage:errorMessage};};export default useFetch;","map":{"version":3,"sources":["/Users/manmanbbg/Desktop/degree/FYP/project/FYP_UI/src/hooks/https/useFetch.js"],"names":["useState","useEffect","useSnackbar","axios","useFetch","initialUrl","skip","apiUrl","window","siteSetting","dev","testApiUrl","url","data","setData","isLoading","setIsLoading","hasError","setHasError","errorMessage","setErrorMessage","enqueueSnackbar","fetchData","token","localStorage","getItem","get","headers","Authorization","response","result","message","variant"],"mappings":"wfAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,OAASC,WAAT,KAA4B,WAA5B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,UAAD,CAA8B,IAAjBC,CAAAA,IAAiB,2DAAV,KAAU,CAC7C,GAAMC,CAAAA,MAAM,CAAGC,MAAM,CAACC,WAAP,CAAmBC,GAAnB,CACXF,MAAM,CAACC,WAAP,CAAmBE,UADR,CAEXH,MAAM,CAACC,WAAP,CAAmBF,MAFvB,CAD6C,cAI/BP,QAAQ,CAACO,MAAM,CAAGF,UAAV,CAJuB,wCAItCO,GAJsC,eAK7C;AAL6C,eAMrBZ,QAAQ,CAAC,EAAD,CANa,yCAMtCa,IANsC,eAMhCC,OANgC,8BAOXd,QAAQ,CAAC,KAAD,CAPG,yCAOtCe,SAPsC,eAO3BC,YAP2B,8BAQbhB,QAAQ,CAAC,KAAD,CARK,yCAQtCiB,QARsC,eAQ5BC,WAR4B,8BASLlB,QAAQ,CAAC,EAAD,CATH,0CAStCmB,YATsC,gBASxBC,eATwB,iCAUjBlB,WAAW,EAVM,CAUrCmB,eAVqC,cAUrCA,eAVqC,CAY7CpB,SAAS,CAAC,UAAM,CACd,GAAMqB,CAAAA,SAAS,0FAAG,iKACZhB,IADY,iEAEhBU,YAAY,CAAC,IAAD,CAAZ,CAFgB,gBAIRO,KAJQ,CAIAC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAJA,uBAKStB,CAAAA,KAAK,CAACuB,GAAN,CAAUd,GAAV,CAAe,CACpCe,OAAO,CAAE,CAAEC,aAAa,kBAAYL,KAAZ,CAAf,CAD2B,CAAf,CALT,QAKRM,QALQ,sCAQOA,CAAAA,QAAQ,CAAChB,IARhB,SAQRiB,MARQ,eASd,GAAIA,MAAJ,CAAY,CACVhB,OAAO,CAACgB,MAAD,CAAP,CACD,CAFD,IAEO,CACLZ,WAAW,CAAC,IAAD,CAAX,CACAE,eAAe,CAACU,MAAD,CAAf,CACD,CAda,iFAgBdZ,WAAW,CAAC,IAAD,CAAX,CACAE,eAAe,CAAC,YAAIW,OAAL,CAAf,CACAV,eAAe,CAAC,gBAAD,CAAmB,CAChCW,OAAO,CAAE,OADuB,CAAnB,CAAf,CAlBc,yBAsBdhB,YAAY,CAAC,KAAD,CAAZ,CAtBc,sGAAH,kBAATM,CAAAA,SAAS,0CAAf,CAyBAA,SAAS,GACV,CA3BQ,CA2BN,CAACV,GAAD,CA3BM,CAAT,CA4BA,MAAO,CAAEC,IAAI,CAAJA,IAAF,CAAQE,SAAS,CAATA,SAAR,CAAmBE,QAAQ,CAARA,QAAnB,CAA6BE,YAAY,CAAZA,YAA7B,CAAP,CACD,CAzCD,CA0CA,cAAef,CAAAA,QAAf","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useSnackbar } from \"notistack\";\nimport axios from \"axios\";\n\nconst useFetch = (initialUrl, skip = false) => {\n  const apiUrl = window.siteSetting.dev\n    ? window.siteSetting.testApiUrl\n    : window.siteSetting.apiUrl;\n  const [url] = useState(apiUrl + initialUrl);\n  // const [params] = useState(initialParams);\n  const [data, setData] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasError, setHasError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const { enqueueSnackbar } = useSnackbar();\n\n  useEffect(() => {\n    const fetchData = async () => {\n      if (skip) return;\n      setIsLoading(true);\n      try {\n        const token = localStorage.getItem(\"Token\");\n        const response = await axios.get(url, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        const result = await response.data;\n        if (result) {\n          setData(result);\n        } else {\n          setHasError(true);\n          setErrorMessage(result);\n        }\n      } catch (err) {\n        setHasError(true);\n        setErrorMessage(err.message);\n        enqueueSnackbar(\"Get Data Error\", {\n          variant: \"error\",\n        });\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchData();\n  }, [url]);\n  return { data, isLoading, hasError, errorMessage };\n};\nexport default useFetch;\n"]},"metadata":{},"sourceType":"module"}